unit comUsl;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, ComCtrls, DBGridEhGrouping, GridsEh, DBGridEh, StdCtrls, OleServer, ComObj, DBGridEhImpExp;

type
  TfCommonUsl = class(TForm)
    DateTimePicker1: TDateTimePicker;
    DateTimePicker2: TDateTimePicker;
    Button1: TButton;
    DBGridEh1: TDBGridEh;
    procedure Button1Click(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  fCommonUsl: TfCommonUsl;

implementation

uses DM;

{$R *.dfm}

procedure TfCommonUsl.Button1Click(Sender: TObject);
begin
 fDM.QComUsl.SQL.Clear;
 fDM.QComUsl.SQL.Add('SELECT Count(rabotnik.id) AS [Count-id], rabotnik.disp_gr FROM rabotnik WHERE (((rabotnik.id_org) In (28,4,1,7,8,20,21,22,17,2,19,3,5,16,15,6,25,31,13,35,27,43,12,34,40,44,29)) AND ((rabotnik.data_proh) Between :date And :date2))GROUP BY rabotnik.disp_gr');
 fDM.QComUsl.Parameters.ParamByName('date').Value:=FormatDateTime('dd.mm.yyyy',DateTimePicker1.Date);
 fDM.QComUsl.Parameters.ParamByName('date2').Value:=FormatDateTime('dd.mm.yyyy',DateTimePicker2.Date);
 fDM.QComUsl.Active:=true;
 fDM.QComUsl.First;
end;

end.
