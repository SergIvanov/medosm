unit user;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, StdCtrls, DBCtrls, ExtCtrls;

type
  TfUser = class(TForm)
    Panel1: TPanel;
    Label1: TLabel;
    Button1: TButton;
    ComboBox1: TComboBox;
    procedure Button1Click(Sender: TObject);
    procedure FormCreate(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  fUser: TfUser;
  us:string;
implementation

uses DM;

{$R *.dfm}

procedure TfUser.Button1Click(Sender: TObject);
var i:integer;
begin
 if ComboBox1.Text='Администратор' then
  begin
    us:=ComboBox1.Text;
    fDm.TRab.Active:=false;
    fDm.TRab.CommandText:='select * from rabotnik';
    fDm.TRab.Active:=true;
    fUser.Close;
  end else begin
  i:=ComboBox1.ItemIndex;
 us:=ComboBox1.Items[i];
 fDm.TRab.Active:=false;
 fDm.TRab.CommandText:='select * from rabotnik where user='+quotedstr(us);
 fDm.TRab.Active:=true;
 fUser.Close;
 end;
end;
procedure TfUser.FormCreate(Sender: TObject);
var f: TextFile;
    str,dir: string;
    i:integer;
begin
 dir:=ExtractFileDir(ParamStr(0))+'\users.ini';
 AssignFile(f, dir);
 reset(f);
 i:=1;
while not eof(f) do begin
 readln(f, str);
 Combobox1.Items[i]:=str;
 inc(i);
end;
closefile(f);
end;

end.
